@(course: Course, data: AttendanceAPI)(implicit request: RequestHeader, flash: Flash)
@import util._

@rowColor(attendanceRate: Double) = @{
  if (attendanceRate <= 25) {
   "table-danger"
  } else if (attendanceRate <= 50) {
   "table-warning"
  } else {
    ""
  }
}
@action = {
<a class="btn btn-primary"
   href="@routes.AttendanceController.newAttendance(course.id)">Import
   Attendance</a>
}

@main(course.title) {
@common.card(course.title)(action) {
@common.responsiveTable {
  <tr>
    <th>Name</th>
    @for((_, d) <- data.dates) {
    <th class="text-center">@d</th>
    }
    <th>Attendance Rate</th>
  </tr>
  @for((_, d) <- data.studentDetails) {
  <tr class="@rowColor(d.stat.attendanceRate)">
    <td>
      <a href="@routes.StudentController.show(d.student.id)">
        @d.student.name
      </a>
    </td>
    @for((_, date) <- data.dates.toList) {
    <td class="text-center">
      @{
      val value = d.attendances.getOrElse(date, "")
      if (value == "attend") {
        <i class="fa fa-check green-text" aria-hidden="true"></i>
      } else if (value == "absent") {
        <i class="fa fa-close red-text" aria-hidden="true"></i>
      } else {
        "-"
      }
      }
    </td>
    }
    <td class="text-center">
      @formatDouble(d.stat.attendanceRate)%
    </td>
    <td>
      @d.stat
    </td>

  </tr>
  }
}
}
}
